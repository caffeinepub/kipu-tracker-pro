{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Fix Mode toggle functionality and case edit update failure",
  "requirements": [
    {
      "id": "REQ-47",
      "summary": "Fix Mode toggle button to properly switch between manual and auto time entry modes",
      "acceptanceCriteria": [
        "Mode toggle button in header navigation responds to clicks",
        "Mode state persists and synchronizes with the CaseTimerControls component",
        "Visual feedback indicates current mode (manual vs auto)",
        "Switching modes updates the time entry interface appropriately"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/Layout.tsx",
          "operation": "modify",
          "description": "Add state management for mode (manual/auto) with useState hook, update the Mode button onClick handler to toggle between modes, and pass the current mode and setter function to children via props or context"
        },
        {
          "path": "frontend/src/components/CaseTimerControls.tsx",
          "operation": "modify",
          "description": "Accept mode prop from parent Layout component, conditionally render time input fields based on mode (show manual datetime inputs when mode is 'manual', hide them and use live timer when mode is 'auto'), update form validation logic to handle both modes, and ensure timer behavior adapts to selected mode"
        },
        {
          "path": "frontend/src/pages/Dashboard.tsx",
          "operation": "modify",
          "description": "Update Dashboard to receive and pass through mode state from Layout to CaseTimerControls component, ensuring proper state flow from header navigation to timer controls"
        }
      ]
    },
    {
      "id": "REQ-48",
      "summary": "Debug and fix case edit functionality to properly update cases in backend and UI",
      "acceptanceCriteria": [
        "EditCaseModal successfully submits edited case data to the backend",
        "Backend editCase function processes updates without errors",
        "Updated case data appears correctly in the case list after editing",
        "Error handling provides clear feedback if update fails",
        "All case fields including EMR classification data can be edited and saved"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/EditCaseModal.tsx",
          "operation": "modify",
          "description": "Debug form submission in handleSubmit function to ensure all required fields are properly extracted from form state, verify datetime conversions using timeHelpers are correct, add console logging to trace data flow, ensure null/undefined EMR fields are handled correctly when calling useEditCase mutation, and add error boundary with user-friendly error messages using toast notifications"
        },
        {
          "path": "frontend/src/hooks/useQueries.ts",
          "operation": "modify",
          "description": "Debug useEditCase hook mutation function to ensure caseId and all parameters are correctly passed to actor.editCase backend method, verify parameter types match backend interface expectations (bigint for caseId and timestamps, correct enum types, null for optional fields), add error logging, ensure optimistic updates and cache invalidation work correctly on success, and add proper error handling with descriptive messages"
        }
      ]
    }
  ]
}